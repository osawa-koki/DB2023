<!doctype html><html lang=ja><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><link rel="shortcut icon" href=https://osawa-koki.github.io/DB2023/Logo.png type=image/x-icon><link rel=stylesheet href=https://osawa-koki.github.io/DB2023/sass/style.min.dc0078058ce9074c96338ad888d8e91b59fba1e714614cf45118578944e151d7.css><link rel=stylesheet href=https://osawa-koki.github.io/DB2023/sass/single.min.4c7c51cf79fbade0103a0aa22d7901040321c00aed7870eb923bc9195b1f8a14.css><link rel=stylesheet href=https://osawa-koki.github.io/DB2023/sass/content.min.29f09606f5140407d848c87a91f73509241b381546612af92f28f53e2fd2de65.css><link rel=stylesheet href=https://osawa-koki.github.io/DB2023/bootstrap-5.0.2-dist/css/bootstrap.min.css><title>リレーショナルモデル | データベーススペシャリスト試験対策</title></head><body><header><a href=https://osawa-koki.github.io/DB2023/><img id=LogoImage src=https://osawa-koki.github.io/DB2023/Logo.png alt=Logo></a></header><main><div id=Single><div id=MainDiv><div id=content-header><div id=content-title>リレーショナルモデル</div><div id=content-description>理解しているようで、理解できていない、リレーショナルモデルについてです。</div><div id=content-date>2022.12.26</div><div id=content-categories><div class=category>DB2023</div><div class=category>教科書</div></div><div id=content-tags><div class=tag>リレーショナルモデル</div><div class=tag>SQL</div></div></div><div id=MainBody><div id=content><h2 id=リレーショナルモデル>リレーショナルモデル</h2><p>関係モデルとも呼ばれます。<br>現実世界に存在するデータを「リレーション(関係)」と呼ばれる概念によって表現するモデルです。</p><blockquote><p>関係モデルとは、データの集合を表現する数学的なモデルの一つ。データ群を複数の項目の「関係」（relation）として捉えるもので、リレーショナルデータベース（RDB）の理論上の基礎となっている。<br>関係モデルでは、一件のデータを複数の値を紐付けた「組」（tuple）として表現する。それぞれの値は「属性」（attribute）に所属しており、組の中では属性名を使って指し示すことができる。各属性はどのような値を取りうるかを定めた定義域（domain）を持つ。<br><a href=https://e-words.jp/w/%E9%96%A2%E4%BF%82%E3%83%A2%E3%83%87%E3%83%AB.html>e-words</a>より。</p></blockquote><h2 id=リレーション>リレーション</h2><p>関係DBではリレーションは<strong>テーブル</strong>に該当します。<br>テーブルは「ヘッダ」と「本体(ボディ)」から構成されます。</p><p>ヘッダはn個の属性(Attribute)の集合であり、本体は組(タプル)の集合です。</p><hr><p>ポケモン図鑑テーブルの例では、ヘッダとして「図鑑暗号: 整数」「名前: 文字列」「世代: 整数」があり、本体には「(25, &lsquo;ピカチュウ&rsquo;, 1)」「(152, &lsquo;チコリータ&rsquo;, 2)」などのタプルが格納されます。</p><p>このような関係がリレーションです。</p><h3 id=null問題>NULL問題</h3><p>ポケモン図鑑のテーブルの見出しを「図鑑暗号: 整数」「名前: 文字列」「タイプ1: 文字列」「タイプ2: 文字列」に修正します。<br>この場合、フシギバナは「(3, &lsquo;フシギバナ&rsquo;, &lsquo;くさ&rsquo;, &lsquo;どく&rsquo;)」となりますが、ピカチュウは「(25, &lsquo;ピカチュウ&rsquo;, &lsquo;でんき&rsquo;)」となり、ヘッダで定義された属性の集合との不一致が発生します。</p><p>このようなヘッダと本体の不一致はリレーションとして不適切とみなされます。</p><p>これを解決するために、NULLという概念を使用して「(25, &lsquo;ピカチュウ&rsquo;, &lsquo;でんき&rsquo;, NULL)」と表現することができますが、これはリレーションとして適切なのかについては諸説あります。</p><hr><p>リレーションは属性の集合である見出しと、当該見出しと一致する定義域を有するタプルの集合であるため、結果的にExcelのような表の形式で表現され、したがって、これを操作するためのSQLが使用されますが、根底にはリレーションとそれをモデル化したリレーショナルモデルという考え方があります。</p><p>これを把握するとSQLで実行される集合演算(和・差・直積・積・商)やSELECT対象、WHERE句による射影と選択が少し違って見えるかもしれません、、、</p><h2 id=集合>集合</h2><p>リレーションは集合として合わらすことができます。<br>数学Aで習った<strong>あの</strong>集合です。</p><p><img src=../img/data-set.png alt=集合></p><p>したがって、集合演算も当然に適用可能です。</p><p>既に学習済みですが、代表的な集合演算として以下のものがあります。</p><ul><li>和</li><li>差</li><li>直積</li><li>積</li><li>商</li></ul><h3 id=選択>選択</h3><p>「選択」によって集合の中から特定の条件に合う要素(タプル)だけを抽出することができます。<br>この時、新たに生成される集合は元の集合と同一であることも考えられますし、空集合であることも考えられます。</p><p>これはWHERE句で実現します。</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sql data-lang=sql><span style=display:flex><span><span style=color:#66d9ef>SELECT</span> number, name
</span></span><span style=display:flex><span><span style=color:#66d9ef>FROM</span> pokemon
</span></span><span style=display:flex><span><span style=color:#66d9ef>WHERE</span> generation <span style=color:#f92672>=</span> <span style=color:#ae81ff>1</span>;
</span></span></code></pre></div><h3 id=射影>射影</h3><p>「射影」によって要素(タプル)のうち、特定の属性からなる新たな集合を生成することもできます。<br>この場合には、集合の性質上、要素が完全に異なるものが出現しないように注意が必要です。</p><p>例えば、ポケモン図鑑テーブルから以下のSQLを実行してタイプ一覧を表示したとします。</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sql data-lang=sql><span style=display:flex><span><span style=color:#66d9ef>SELECT</span> type1
</span></span><span style=display:flex><span><span style=color:#66d9ef>FROM</span> pokekon;
</span></span></code></pre></div><p>タイプ1がくさであるポケモンは複数存在しますから、くさタイプという要素がひとつの集合内で複数存在することになります。<br>これは集合の性質に違反していますので、原則として射影時にはDISTINCT句を付けるべきといえます。</p><p>パフォーマンスの観点から付けないことが多いですが、、、</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sql data-lang=sql><span style=display:flex><span><span style=color:#66d9ef>SELECT</span> <span style=color:#66d9ef>DISTINCT</span> type1
</span></span><span style=display:flex><span><span style=color:#66d9ef>FROM</span> pokekon;
</span></span></code></pre></div><p>もとの集合に関しても当然に要素の重複は許されません。</p><h3 id=集合の拡張>集合の拡張</h3><p>拡張は射影とは逆に属性を追加する集合演算です。<br>例えば、全てのステータスを合計してトータルという属性を新たに生成する演算が該当します。</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sql data-lang=sql><span style=display:flex><span><span style=color:#66d9ef>SELECT</span> hp, attack, defence, sp_attack, sp_defence, speed, (hp <span style=color:#f92672>+</span> attack <span style=color:#f92672>+</span> defence <span style=color:#f92672>+</span> sp_attack <span style=color:#f92672>+</span> sp_defence <span style=color:#f92672>+</span> speed) <span style=color:#66d9ef>AS</span> total
</span></span><span style=display:flex><span><span style=color:#66d9ef>FROM</span> pokemon;
</span></span></code></pre></div><h3 id=ヘッダのリネーム>ヘッダのリネーム</h3><p>ヘッダに別名を付けることもできます。<br>AS句が該当します。</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sql data-lang=sql><span style=display:flex><span><span style=color:#66d9ef>SELECT</span> number <span style=color:#66d9ef>AS</span> id
</span></span><span style=display:flex><span><span style=color:#66d9ef>FROM</span> pokemon;
</span></span></code></pre></div><h3 id=集合の性質>集合の性質</h3><p>集合には以下の性質があります</p><ul><li>要素間での順番は存在しない。</li><li>要素の重複は存在しない。</li></ul><h2 id=ドメイン>ドメイン</h2><p>集合に属する要素が取りうる値の範囲のことで、定義域とも呼ばれます。<br>一般的にはデータ型が該当しますが、既に説明したとおり、データ型に対して制約を課すことでより詳細にその値を指定することができます。</p><p>例えば、郵便番号は文字列として格納されますが、「xxx-xxxx」の形式を満たす必要があります。<br>このような場合に、定義域を使用することで「xxx-xxxx」の形式を満たさないデータを排除することができます。</p><p>定義域は以下のように定義します。</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sql data-lang=sql><span style=display:flex><span><span style=color:#66d9ef>CREATE</span> <span style=color:#66d9ef>DOMAIN</span> <span style=color:#960050;background-color:#1e0010>定義域名</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>AS</span> <span style=color:#960050;background-color:#1e0010>データ型</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>CHECK</span>(...);
</span></span></code></pre></div><p>例えば、郵便番号用の定義域は以下のように定義することができます。</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sql data-lang=sql><span style=display:flex><span><span style=color:#66d9ef>CREATE</span> <span style=color:#66d9ef>DOMAIN</span> postal_code
</span></span><span style=display:flex><span><span style=color:#66d9ef>AS</span> CHAR(<span style=color:#ae81ff>8</span>)
</span></span><span style=display:flex><span><span style=color:#66d9ef>CHECK</span>(postal_code <span style=color:#66d9ef>LIKE</span> <span style=color:#e6db74>&#39;___-____&#39;</span>);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>---
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>
</span></span><span style=display:flex><span>[<span style=color:#960050;background-color:#1e0010>カラム</span>(SQL<span style=color:#960050;background-color:#1e0010>とリレーショナルモデル</span>)](..<span style=color:#f92672>/</span><span style=color:#66d9ef>column</span><span style=color:#f92672>/</span>SQL<span style=color:#960050;background-color:#1e0010>とリレーショナルモデル</span>.md)  
</span></span></code></pre></div></div></div></div><div id=SubDiv><div id=Menu><div class=title>教科書</div><a href=https://osawa-koki.github.io/DB2023/textbook/%e3%83%9b%e3%83%bc%e3%83%a0>ホーム</a>
<a href=https://osawa-koki.github.io/DB2023/textbook/%e3%83%87%e3%83%bc%e3%82%bf%e3%83%99%e3%83%bc%e3%82%b9%e5%9f%ba%e7%a4%8e>データベース基礎</a>
<a href=https://osawa-koki.github.io/DB2023/textbook/sql%e3%81%ae%e7%a8%ae%e9%a1%9e>SQLの種類</a>
<a href=https://osawa-koki.github.io/DB2023/textbook/%e3%83%87%e3%83%bc%e3%82%bf%e6%93%8d%e4%bd%9c%e8%a8%80%e8%aa%9e>データ操作言語</a>
<a href=https://osawa-koki.github.io/DB2023/textbook/%e3%83%86%e3%83%bc%e3%83%96%e3%83%ab%e3%81%ae%e7%b5%90%e5%90%88>テーブルの結合</a>
<a href=https://osawa-koki.github.io/DB2023/textbook/%e9%9b%86%e5%90%88%e6%bc%94%e7%ae%97>集合演算</a>
<a href=https://osawa-koki.github.io/DB2023/textbook/%e5%89%af%e5%95%8f%e3%81%84%e5%90%88%e3%82%8f%e3%81%9b>副問い合わせ</a>
<a href=https://osawa-koki.github.io/DB2023/textbook/%e3%83%87%e3%83%bc%e3%82%bf%e5%ae%9a%e7%be%a9%e8%a8%80%e8%aa%9e>データ定義言語</a>
<a href=https://osawa-koki.github.io/DB2023/textbook/%e3%83%87%e3%83%bc%e3%82%bf%e5%88%b6%e5%be%a1%e8%a8%80%e8%aa%9e>データ制御言語</a>
<a href=https://osawa-koki.github.io/DB2023/textbook/%e5%9f%8b%e8%be%bc%e3%81%bf%e5%9e%8bsql>埋込み型SQL</a>
<a href=https://osawa-koki.github.io/DB2023/textbook/%e3%83%aa%e3%83%ac%e3%83%bc%e3%82%b7%e3%83%a7%e3%83%8a%e3%83%ab%e3%83%a2%e3%83%87%e3%83%ab class=active>リレーショナルモデル</a>
<a href=https://osawa-koki.github.io/DB2023/textbook/%e6%a6%82%e5%bf%b5%e3%83%87%e3%83%bc%e3%82%bf%e3%83%a2%e3%83%87%e3%83%ab>概念データモデル</a><div class=title>カラム</div><a href=https://osawa-koki.github.io/DB2023/column/%e5%87%ba%e9%a1%8c%e5%82%be%e5%90%91/>出題傾向</a>
<a href=https://osawa-koki.github.io/DB2023/column/db%e8%a9%a6%e9%a8%93-%e6%88%a6%e7%95%a5%e7%9a%84%e5%ad%a6%e7%bf%92%e3%81%ae%e3%82%b9%e3%82%b9%e3%83%a1/>DB試験-戦略的学習のススメ</a>
<a href=https://osawa-koki.github.io/DB2023/column/sql%e3%81%a8%e3%83%aa%e3%83%ac%e3%83%bc%e3%82%b7%e3%83%a7%e3%83%8a%e3%83%ab%e3%83%a2%e3%83%87%e3%83%ab/>SQLとリレーショナルモデル</a></div></div></div><div><div id=ButtonContainer><a class="btn btn-success" href=https://osawa-koki.github.io/DB2023/textbook/%e5%9f%8b%e8%be%bc%e3%81%bf%e5%9e%8bsql id=PrevButton>前へ</a>
<a class="btn btn-primary" href=https://osawa-koki.github.io/DB2023/textbook/%e6%a6%82%e5%bf%b5%e3%83%87%e3%83%bc%e3%82%bf%e3%83%a2%e3%83%87%e3%83%ab id=NextButton>次へ</a></div></div></main><footer></footer></body></html>