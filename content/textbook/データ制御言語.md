---
title: "データ制御言語"
date: 2022-12-25T23:12:04+09:00
draft: false
description: "セキュリティの要となる権限についてです。データベースのセキュリティ、とっても大切です！"
categories: ["DB2023", "教科書"]
tags: ["セキュリティ", "SQL"]
---

## データベースセキュリティ

セキュリティってどれも大切ですが、データベースに関するセキュリティってその中でも本当に大切です。  
参考までに、サイボウズのバグバウンティでの各種類の攻撃方法での最低価格を少し紹介しますね♪  

| 攻撃名 | 報奨金額 |
| ---- | ---- |
| SQLインジェクション | 60,000 |
| インジェクション(SQL以外) | 20,000 |
| アクセス制御の不備 | 20,000 |
| 入力確認の不備 | 20,000 |
| XSS | 40,000 |

※ 引用元は[こちら](https://cybozu.co.jp/products/bug-bounty/)  

## 権限

あるデータに対して特定の処理をしていいか否かです。  
セキュリティの基本部分ですが、この設定周りのミスはヒューマンエラーとして発生することが多々あります。  
めんどくさいから、とりあえず権限付与しておけばいいや、的な、、、  

データベースのセキュリティに関しては、「SQLインジェクション攻撃」と「権限(認証)」がほとんどです。  

どちらも非常に簡単に対応できます。  

権限に関してはアクセスしてもOKばユーザ(ロール)に対して適切な権限をあたえて、それ以外には与えないだけです。  

また、「SQLインジェクション攻撃」に関しては後ほど説明しますが、「エスケープ処理」か「バインド機構」のいずれかで対応できます。  

ここでしっかりと権限に関してはマスターしましょう♪  

---

権限とは「**誰が**」「**どの資源に**」「**どんな処理を**」していいかを示すものです。  
したがって、権限に関するSQLではこの3つを強く意識してください。  

|  | 説明 |
| ---- | ---- |
| 誰が | ユーザ(ロール) |
| どの資源に | テーブル(ビュー) |
| どんな処理を | SELECT/INSERT/UPDATE/DELETE |

## ユーザベース制御とロールベース制御

権限を設定する際に、数百人単位で全て設定するのは大変ですよね、、、  
したがって、役割(ロール)でユーザを一括管理して、そのユーザに権限を付すことで、ユーザの管理を楽にすることが一般的です。  
例えば、役職(部長・PMPL・SEPG)などで一括して権限を付す場合です。  

ロールベース制御は間にロールを挟む分、そこで不備が発生しやすいことに注意して下さい。  

## GRANT文

ユーザ、またはロールに対して権限を付すためのSQLです。  

```sql
GRANT 権限
ON 対象資源
TO ユーザ(ロール)
[WITH GRANT OPTION];
```

|  | 説明 |
| ---- | ---- |
| 権限 | SELECT/INSERT/UPDATE/DELETEを指定します。  ALL PRIVILEDGESで全ての権限を与えることができます。 |
| 対象資源 | テーブル名、またはビュー名を指定します。 |
| ユーザ(ロール) | 権限の付与対象であるユーザ、ロールを指定します。 |
| WITH GRANT OPTION | 権限を与えられたユーザが、他のユーザに与えられた権限を与えることを許可するかを指定します。 |

## REVOKE文

権限を剥奪します。  

```sql
REVOKE 権限
ON 対象資源
FROM ユーザ(ロール);
```

説明は権限の付与と同じです。  

|  | 説明 |
| ---- | ---- |
| 権限 | SELECT/INSERT/UPDATE/DELETEを指定します。  ALL PRIVILEDGESで全ての権限を与えることができます。 |
| 対象資源 | テーブル名、またはビュー名を指定します。 |
| ユーザ(ロール) | 権限の付与対象であるユーザ、ロールを指定します。 |

